{% extends "pdl/base.html" %}


{% load staticfiles %}
{% block additional_head_javascript %}
    <script src='{% static "js/Chart.min.js" %}'></script>
{% endblock additional_head_javascript %}


{% block additional_css %}
<style>
#g1, #g2, #g3, #g4 {
    width:240px; height:192px;
    display: inline-block;
    margin: 1em;
}
</style>
{% endblock %}


{% block title %}
        Proyecto de ley | Estadísticas
{% endblock %}

{% load humanize %}
{% block content %}
<div class="container">
  <h1 id="proyectos_de_ley">Situación de los proyectos de ley</h1>
  <hr>
  <h3>Número total de proyectos de ley:
    <a href="/">{{ numero_de_proyectos|intcomma }}</a></h3>
</div>

<div id="contenido" class="container">
  <div class="container">

    <div id="g1"></div>
    <div id="g2"></div>
    <div id="g3"></div>
    <div id="g4"></div>

  </div><!-- container -->

  <div class="container">
    <h4>Número de proyectos estancados en cada comisión del Congreso</h3>
    <canvas id="comisiones_chart" width="600" height="300"></canvas>
  </div>
</div>


{% endblock content %}

{% block additional_javascript %}
{% load staticfiles %}
<script src="{% static 'js/raphael.2.1.0.min.js' %}"></script>
<script src="{% static 'js/justgage.1.0.1.min.js' %}"></script>

<script>
  var ctx = document.getElementById("comisiones_chart").getContext("2d");
  var data = {
    labels: {{ comision_names|safe }},
    datasets: [
        {
            label: "My firt dataset",
            fillColor: "rgba(220,220,220,0.5)",
            strokeColor: "rgba(220,220,220,0.8)",
            highlightFill: "rgba(220,220,220,0.75)",
            highlightStroke: "rgba(220,220,220,1)",
            data: {{ comision_count|safe }}
        }
    ]
  };
  var comisiones_chart = new Chart(ctx).Bar(data);

  var g = new JustGage({
    id: "g1",
    value: {{ percentage_without_pdf_url }},
    label: "{{ without_pdf_url|intcomma }} proyectos",
    min: 0,
    max: 100,
    levelColorsGradient: false,
    title: "% sin PDF link"
  });

  var g = new JustGage({
    id: "g2",
    value: {{ percentage_without_iniciativas }},
    label: "{{ without_iniciativas|intcomma }} proyectos",
    min: 0,
    max: 100,
    levelColorsGradient: false,
    title: "% proyectos sin fusionar"
  });

  var g = new JustGage({
    id: "g3",
    value: {{ percentage_without_seguimientos }},
    label: "{{ without_seguimientos|intcomma }} proyectos",
    min: 0,
    max: 100,
    levelColorsGradient: false,
    title: "% sin tramitar"
  });

  var g = new JustGage({
    id: "g4",
    value: {{ percentage_are_not_law }},
    label: "{{ are_not_law|intcomma }} proyectos",
    min: 0,
    max: 100,
    levelColorsGradient: false,
    title: "% proyectos que\naún no son ley"
  });
</script>
{% endblock additional_javascript %}
