{% extends "pdl/base.html" %}


{% block additional_head_javascript %}
<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.12/d3.min.js" charset="utf-8"></script>
{% endblock additional_head_javascript %}


{% block additional_css %}
<style>
.node {
  stroke: #fff;
  stroke-width: 1.5px;
}
.link {
  stroke: #999;
  stroke-opacity: .6;
}
</style>
{% endblock %}



{% block title %}
        Proyecto de ley | Seguimiento
{% endblock %}


{% load humanize %}
{% block content %}
<div class="container">
  <h1 id="proyectos_de_ley">Proyecto de Ley {{ item.codigo }}</h1>
  <p>Presentado: {{ item.fecha_presentacion|naturalday }}</p>
</div>

<div id="contenido" class="container">


  <div class="container">
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading"><b>Título</b></div>
          <div class="panel-body">
            {{ item.titulo }}
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->

    {% if item.congresistas_with_links != None %}
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading">
            <b>Autores</b>
            <span class="badge">{{ item.numero_congresistas }}</span>
          </div>
          <div class="panel-body">
            {{ item.congresistas_with_links|safe }}
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->
    {% endif %}

    {% if item.iniciativas_agrupadas|length > 1 %}
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading">
            <b>Iniciativas agrupadas</b>
            <span class="badge">{{ item.iniciativas_agrupadas|length }}</span>
          </div>
          <div class="panel-body">
            <div id="iniciativas"></div>
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->
    {% endif %}

    {% if item.proponente != None %}
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading"><b>Proponente</b></div>
          <div class="panel-body">
            {{ item.proponente|safe }}
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->
    {% endif %}

    {% if item.proponente != None %}
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading"><b>Grupo parlamentario</b></div>
          <div class="panel-body">
            {{ item.grupo_parlamentario|safe }}
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->
    {% endif %}

    {% if item.nombre_comision != None %}
    <div class="row">
      <div class="col-lg-7 col-md-8 col-sm-11">
        <div class="panel panel-default">
          <div class="panel-heading"><b>Nombre de comisión</b></div>
          <div class="panel-body">
            {{ item.nombre_comision|safe }}
          </div>
        </div>
      </div><!-- col -->
    </div><!-- row -->
    {% endif %}

  </div><!-- container -->
</div>


{% endblock content %}


{% block additional_javascript %}
<script>
$.getJSON("/api/iniciativas/{{ item.short_url }}", function(data) {
    var items = [];
    $.each(data.nodes, function(k, v) {
        items.push("<a href='" + v.url + "' title='Proyecto " + v.codigo + "'>" + v.codigo + "</a>")
    });
    $("#iniciativas").append(items.join(", "));
});
</script>
{% endblock additional_javascript %}
